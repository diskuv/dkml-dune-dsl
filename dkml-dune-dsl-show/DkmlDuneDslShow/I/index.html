<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>I (dkml-dune-dsl-show.DkmlDuneDslShow.I)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">dkml-dune-dsl-show</a> &#x00BB; <a href="../index.html">DkmlDuneDslShow</a> &#x00BB; I</nav><header class="odoc-preamble"><h1>Module <code><span>DkmlDuneDslShow.I</span></code></h1><p>An interpreter of the Dune DSL whose interpreted result is a s-exp of a valid Dune file parameterizable by Mustache JSON configuration.</p><p>Use <a href="../index.html#val-plain_hum"><code>plain_hum</code></a> or <a href="../index.html#val-pretty"><code>pretty</code></a> to show the Dune file.</p></header><nav class="odoc-toc"><ul><li><a href="#stanzas">Stanzas</a><ul><li><a href="#rules">Rules</a><ul><li><a href="#dependencies">Dependencies</a></li><li><a href="#actions">Actions</a></li></ul></li><li><a href="#executables-and-libraries">Executables and Libraries</a><ul><li><a href="#preprocessing">Preprocessing</a></li></ul></li><li><a href="#install">Install</a><ul><li><a href="#install-destination">Install Destination</a></li></ul></li></ul></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-repr" class="anchored"><a href="#type-repr" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a repr</span></span><span> = <span><span class="xref-unresolved">Mustache</span>.Json.t <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Sexplib</span>.Sexp.With_layout.t</span></code></div><div class="spec-doc"><p>A type that represents a Dune file.</p></div></div><h3 id="stanzas"><a href="#stanzas" class="anchor"></a>Stanzas</h3><div class="odoc-spec"><div class="spec value" id="val-rule" class="anchored"><a href="#val-rule" class="anchor"></a><code><span><span class="keyword">val</span> rule : <span><span><span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Stanza ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p>The <code>rule [rule_clause1 ...]</code> stanza is used to create custom user rules. It tells Dune how to generate a specific set of files from a specific set of dependencies.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-executable" class="anchored"><a href="#val-executable" class="anchor"></a><code><span><span class="keyword">val</span> executable : <span><span><span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Stanza ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p>The <code>executable [name &quot;&lt;name&gt;&quot;; ...]</code> stanza must be used to describe an executable.</p><p><code>&quot;&lt;name&gt;&quot;</code> is a module name that contains the executable’s main entry point. There can be additional modules in the current directory; you only need to specify the entry point. Given an executable stanza with <code>name &quot;&lt;name&gt;&quot;; ...</code>, Dune will know how to build <code>&quot;&lt;name&gt;.exe&quot;</code>. If requested, it will also know how to build <code>&quot;&lt;name&gt;.bc&quot;</code> and <code>&quot;&lt;name&gt;.bc.js&quot;</code>. Dune 2.0 and up also need specific configuration (see the <code>modes</code> optional field below).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-library" class="anchored"><a href="#val-library" class="anchor"></a><code><span><span class="keyword">val</span> library : <span><span><span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Stanza ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p>The <code>library [name &quot;&lt;library-name&gt;&quot;; ...]</code> stanza must be used to describe OCaml libraries.</p><p><code>&quot;&lt;library-name&gt;&quot;</code> is the real name of the library. It determines the names of the archive files generated for the library as well as the module name under which the library will be available, unless <code>wrapped false</code> is used (see <code>wrapped</code>). It must be a valid OCaml module name, but it doesn’t need to start with an uppercase letter.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-install" class="anchored"><a href="#val-install" class="anchor"></a><code><span><span class="keyword">val</span> install : <span><span><span><span>[ `Install ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Stanza ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><h4 id="rules"><a href="#rules" class="anchor"></a>Rules</h4><div class="odoc-spec"><div class="spec value" id="val-alias" class="anchored"><a href="#val-alias" class="anchor"></a><code><span><span class="keyword">val</span> alias : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-targets" class="anchored"><a href="#val-targets" class="anchor"></a><code><span><span class="keyword">val</span> targets : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-target" class="anchored"><a href="#val-target" class="anchor"></a><code><span><span class="keyword">val</span> target : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-deps" class="anchored"><a href="#val-deps" class="anchor"></a><code><span><span class="keyword">val</span> deps : <span><span><span><span>[ `Dep ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>deps [dep1; ...]</code> declares dependencies <code>[dep1; ...]</code> required by the rule.</p><p>See <code>Dependencies</code> for which dependencies are allowed.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-action" class="anchored"><a href="#val-action" class="anchor"></a><code><span><span class="keyword">val</span> action : <span><span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>action &lt;action&gt;</code> is what you run to produce the targets from the dependencies.</p></div></div><h5 id="dependencies"><a href="#dependencies" class="anchor"></a>Dependencies</h5><div class="odoc-spec"><div class="spec value" id="val-glob_files" class="anchored"><a href="#val-glob_files" class="anchor"></a><code><span><span class="keyword">val</span> glob_files : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Dep ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-named_dep" class="anchored"><a href="#val-named_dep" class="anchor"></a><code><span><span class="keyword">val</span> named_dep : <span>name:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Dep ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><h5 id="actions"><a href="#actions" class="anchor"></a>Actions</h5><div class="odoc-spec"><div class="spec value" id="val-echo" class="anchored"><a href="#val-echo" class="anchor"></a><code><span><span class="keyword">val</span> echo : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-with_stdout_to" class="anchored"><a href="#val-with_stdout_to" class="anchor"></a><code><span><span class="keyword">val</span> with_stdout_to : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-progn" class="anchored"><a href="#val-progn" class="anchor"></a><code><span><span class="keyword">val</span> progn : <span><span><span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-run" class="anchored"><a href="#val-run" class="anchor"></a><code><span><span class="keyword">val</span> run : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-diff" class="anchored"><a href="#val-diff" class="anchor"></a><code><span><span class="keyword">val</span> diff : <span>actual:string <span class="arrow">&#45;&gt;</span></span> <span>expected:string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-diff_q" class="anchored"><a href="#val-diff_q" class="anchor"></a><code><span><span class="keyword">val</span> diff_q : <span>actual:string <span class="arrow">&#45;&gt;</span></span> <span>expected:string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><h4 id="executables-and-libraries"><a href="#executables-and-libraries" class="anchor"></a>Executables and Libraries</h4><div class="odoc-spec"><div class="spec value" id="val-public_name" class="anchored"><a href="#val-public_name" class="anchor"></a><code><span><span class="keyword">val</span> public_name : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-name" class="anchored"><a href="#val-name" class="anchor"></a><code><span><span class="keyword">val</span> name : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-libraries" class="anchored"><a href="#val-libraries" class="anchor"></a><code><span><span class="keyword">val</span> libraries : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-modules" class="anchored"><a href="#val-modules" class="anchor"></a><code><span><span class="keyword">val</span> modules : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-modes_byte_exe" class="anchored"><a href="#val-modes_byte_exe" class="anchor"></a><code><span><span class="keyword">val</span> modes_byte_exe : <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-ocamlopt_flags" class="anchored"><a href="#val-ocamlopt_flags" class="anchor"></a><code><span><span class="keyword">val</span> ocamlopt_flags : 
  <span><span><span><span>[ `OCamlOptFlag ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-preprocess" class="anchored"><a href="#val-preprocess" class="anchor"></a><code><span><span class="keyword">val</span> preprocess : <span><span><span>[ `PreprocessSpec ]</span> <a href="#type-repr">repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>preprocess spec</code> specifies how to preprocess files when needed. The default is <a href="#val-no_preprocessing"><code>no_preprocessing</code></a>.</p><p>The full list of specifications is in <code>Preprocessing</code>.</p></div></div><h5 id="preprocessing"><a href="#preprocessing" class="anchor"></a>Preprocessing</h5><div class="odoc-spec"><div class="spec value" id="val-no_preprocessing" class="anchored"><a href="#val-no_preprocessing" class="anchor"></a><code><span><span class="keyword">val</span> no_preprocessing : <span><span>[ `PreprocessSpec ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>no_preprocessing</code> tells Dune to give files as-is to the compiler</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pps" class="anchored"><a href="#val-pps" class="anchor"></a><code><span><span class="keyword">val</span> pps : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `PreprocessSpec ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>pps [ppx1; ppx2; ...]</code> preprocesses files using the given list of PPX rewriters</p></div></div><div class="odoc-spec"><div class="spec value" id="val-staged_pps" class="anchored"><a href="#val-staged_pps" class="anchor"></a><code><span><span class="keyword">val</span> staged_pps : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `PreprocessSpec ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>staged_pps [ppx1; ppx2; ...]</code> preprocesses files using the given list of PPX rewriters <b>after</b> dependency analysis.</p><p>It is slower than <a href="#val-pps"><code>pps</code></a>, but you must use <code>staged_pps</code> instead of <code>pps</code> in order to force Dune to use the following pipeline:</p><ol><li>first stage of code generation</li><li>dependency analysis</li><li>second step of code generation in parallel with compilation</li></ol></div></div><div class="odoc-spec"><div class="spec value" id="val-future_syntax" class="anchored"><a href="#val-future_syntax" class="anchor"></a><code><span><span class="keyword">val</span> future_syntax : <span><span>[ `PreprocessSpec ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>future_syntax</code> is equivalent to <a href="#val-no_preprocessing"><code>no_preprocessing</code></a> when using one of the most recent versions of the compiler. When using an older one, it is a shim preprocessor that backports some of the newer syntax elements. This allows you to use some of the new OCaml features while keeping compatibility with older compilers.</p></div></div><h4 id="install"><a href="#install" class="anchor"></a>Install</h4><div class="odoc-spec"><div class="spec value" id="val-section" class="anchored"><a href="#val-section" class="anchor"></a><code><span><span class="keyword">val</span> section : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Install ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-install_files" class="anchored"><a href="#val-install_files" class="anchor"></a><code><span><span class="keyword">val</span> install_files : <span><span><span><span>[ `InstallDestination ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Install ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><a href="https://dune.readthedocs.io/en/stable/dune-files.html#install-1">https://dune.readthedocs.io/en/stable/dune-files.html#install-1</a>.</p><p>Can either be:</p><pre>      (files   (mylib.el as emacs/site-lisp/mylib.el))</pre><p>or</p><pre>      (files hello.txt)</pre></div></div><h5 id="install-destination"><a href="#install-destination" class="anchor"></a>Install Destination</h5><div class="odoc-spec"><div class="spec value" id="val-destination_file" class="anchored"><a href="#val-destination_file" class="anchor"></a><code><span><span class="keyword">val</span> destination_file : 
  <span>filename:string <span class="arrow">&#45;&gt;</span></span>
  <span>destination:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `InstallDestination ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><a href="https://dune.readthedocs.io/en/stable/dune-files.html#install-1">https://dune.readthedocs.io/en/stable/dune-files.html#install-1</a>.</p><p>Represents:</p><pre>      (mylib.el as emacs/site-lisp/mylib.el)</pre><p>in</p><pre>        (files   (mylib.el as emacs/site-lisp/mylib.el))</pre></div></div></div></body></html>