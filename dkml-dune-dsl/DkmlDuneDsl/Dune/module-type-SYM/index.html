<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>SYM (dkml-dune-dsl.DkmlDuneDsl.Dune.SYM)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../../index.html">dkml-dune-dsl</a> &#x00BB; <a href="../../index.html">DkmlDuneDsl</a> &#x00BB; <a href="../index.html">Dune</a> &#x00BB; SYM</nav><header class="odoc-preamble"><h1>Module type <code><span>Dune.SYM</span></code></h1><p>The module type for an embedded domain specific language (eDSL) that describes a Dune file.</p></header><nav class="odoc-toc"><ul><li><a href="#stanzas">Stanzas</a><ul><li><a href="#rules">Rules</a><ul><li><a href="#dependencies">Dependencies</a></li><li><a href="#actions">Actions</a></li></ul></li><li><a href="#executables-and-libraries">Executables and Libraries</a><ul><li><a href="#preprocessing">Preprocessing</a></li><li><a href="#ordered-sets">Ordered Sets</a></li></ul></li><li><a href="#install">Install</a><ul><li><a href="#install-destination">Install Destination</a></li></ul></li></ul></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-repr" class="anchored"><a href="#type-repr" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a repr</span></span></code></div><div class="spec-doc"><p>A type that represents a Dune file.</p></div></div><h3 id="stanzas"><a href="#stanzas" class="anchor"></a>Stanzas</h3><div class="odoc-spec"><div class="spec value" id="val-rule" class="anchored"><a href="#val-rule" class="anchor"></a><code><span><span class="keyword">val</span> rule : <span><span><span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Stanza ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p>The <code>rule [rule_clause1 ...]</code> stanza is used to create custom user rules. It tells Dune how to generate a specific set of files from a specific set of dependencies.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-executable" class="anchored"><a href="#val-executable" class="anchor"></a><code><span><span class="keyword">val</span> executable : <span><span><span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Stanza ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p>The <code>executable [name &quot;&lt;name&gt;&quot;; ...]</code> stanza must be used to describe an executable.</p><p><code>&quot;&lt;name&gt;&quot;</code> is a module name that contains the executable’s main entry point. There can be additional modules in the current directory; you only need to specify the entry point. Given an executable stanza with <code>name &quot;&lt;name&gt;&quot;; ...</code>, Dune will know how to build <code>&quot;&lt;name&gt;.exe&quot;</code>. If requested, it will also know how to build <code>&quot;&lt;name&gt;.bc&quot;</code> and <code>&quot;&lt;name&gt;.bc.js&quot;</code>. Dune 2.0 and up also need specific configuration (see the <a href="#val-modes"><code>modes</code></a> optional field below).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-library" class="anchored"><a href="#val-library" class="anchor"></a><code><span><span class="keyword">val</span> library : <span><span><span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Stanza ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p>The <code>library [name &quot;&lt;library-name&gt;&quot;; ...]</code> stanza must be used to describe OCaml libraries.</p><p><code>&quot;&lt;library-name&gt;&quot;</code> is the real name of the library. It determines the names of the archive files generated for the library as well as the module name under which the library will be available, unless <code>wrapped false</code> is used (see <code>wrapped</code>). It must be a valid OCaml module name, but it doesn’t need to start with an uppercase letter.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-install" class="anchored"><a href="#val-install" class="anchor"></a><code><span><span class="keyword">val</span> install : <span><span><span><span>[ `Install ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Stanza ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-pragma" class="anchored"><a href="#val-pragma" class="anchor"></a><code><span><span class="keyword">val</span> pragma : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span>[ `Stanza ]</span> <a href="#type-repr">repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Stanza ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>pragma instruction stanza</code> gives an <code>instruction</code> to the interpreter that modifies the behavior of a Dune <code>stanza</code>.</p><p>The standard pragmas are:</p><ol><li><code>&quot;once&quot;</code> - Use this for the <b>dkml-dune-dsl-show</b> interpreter, and any other compliant interpreter, to indicate that the <code>stanza</code> should be included at most once. Often you will have common build rules that should not be include multiple times simply because you have multiple parameter sets.</li></ol><p>For the <b>dkml-dune-dsl-show</b> interpreter, a tell-tale sign that you should use <code>&quot;once&quot;</code> is when your rules do not have any parameters <code>&quot;{{ }}&quot;</code> in them.</p></div></div><h4 id="rules"><a href="#rules" class="anchor"></a>Rules</h4><div class="odoc-spec"><div class="spec value" id="val-alias" class="anchored"><a href="#val-alias" class="anchor"></a><code><span><span class="keyword">val</span> alias : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-targets" class="anchored"><a href="#val-targets" class="anchor"></a><code><span><span class="keyword">val</span> targets : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-target" class="anchored"><a href="#val-target" class="anchor"></a><code><span><span class="keyword">val</span> target : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-deps" class="anchored"><a href="#val-deps" class="anchor"></a><code><span><span class="keyword">val</span> deps : <span><span><span><span>[ `Dep ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>deps [dep1; ...]</code> declares dependencies <code>[dep1; ...]</code> required by the rule.</p><p>See <code>Dependencies</code> for which dependencies are allowed.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-action" class="anchored"><a href="#val-action" class="anchor"></a><code><span><span class="keyword">val</span> action : <span><span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `RuleClause ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>action &lt;action&gt;</code> is what you run to produce the targets from the dependencies.</p></div></div><h5 id="dependencies"><a href="#dependencies" class="anchor"></a>Dependencies</h5><div class="odoc-spec"><div class="spec value" id="val-glob_files" class="anchored"><a href="#val-glob_files" class="anchor"></a><code><span><span class="keyword">val</span> glob_files : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Dep ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-named_dep" class="anchored"><a href="#val-named_dep" class="anchor"></a><code><span><span class="keyword">val</span> named_dep : <span>name:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Dep ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><h5 id="actions"><a href="#actions" class="anchor"></a>Actions</h5><div class="odoc-spec"><div class="spec value" id="val-echo" class="anchored"><a href="#val-echo" class="anchor"></a><code><span><span class="keyword">val</span> echo : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-with_stdout_to" class="anchored"><a href="#val-with_stdout_to" class="anchor"></a><code><span><span class="keyword">val</span> with_stdout_to : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>with_stdout_to filename action</code> redirects the output of action <code>action</code> to the file named <code>filename</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-progn" class="anchored"><a href="#val-progn" class="anchor"></a><code><span><span class="keyword">val</span> progn : <span><span><span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>progn [action1; action2; ...]</code> executes several actions <code>action1; ...</code> in sequence</p></div></div><div class="odoc-spec"><div class="spec value" id="val-run" class="anchored"><a href="#val-run" class="anchor"></a><code><span><span class="keyword">val</span> run : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>run [prog; arg1; arg2; ...]</code> runs the program <code>prog</code> and gives it arguments <code>arg1; arg2; ...</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-diff" class="anchored"><a href="#val-diff" class="anchor"></a><code><span><span class="keyword">val</span> diff : <span>actual:string <span class="arrow">&#45;&gt;</span></span> <span>expected:string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>diff ~actual ~expected</code> is similar to <code>run [&quot;diff&quot;; &quot;&lt;actual&gt;&quot;; &quot;&lt;expected&gt;&quot;]</code> but is better and allows promotion. See <a href="https://dune.readthedocs.io/en/stable/concepts.html#diffing-and-promotion">Diffing and promotion</a> for more details.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-diff_q" class="anchored"><a href="#val-diff_q" class="anchor"></a><code><span><span class="keyword">val</span> diff_q : <span>actual:string <span class="arrow">&#45;&gt;</span></span> <span>expected:string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>diff_q ~actual ~expected</code> is the <code>&quot;diff?&quot;</code> action in a &quot;dune&quot; file, and is similar to <code>run [&quot;diff&quot;; &quot;&lt;actual&gt;&quot;; &quot;&lt;expected&gt;&quot;]</code> except that <code>&quot;&lt;expected&gt;&quot;</code> should be produced by a part of the same action rather than be a dependency, is optional and will be consumed by <code>diff_q</code>. See <a href="https://dune.readthedocs.io/en/stable/concepts.html#diffing-and-promotion">Diffing and promotion</a> for more details.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-setenv" class="anchored"><a href="#val-setenv" class="anchor"></a><code><span><span class="keyword">val</span> setenv : 
  <span>name:string <span class="arrow">&#45;&gt;</span></span>
  <span>value:string <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `Action ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>setenv ~name ~value action</code> sets the environment variable <code>name</code> to <code>value</code> in the action <code>action</code></p></div></div><h4 id="executables-and-libraries"><a href="#executables-and-libraries" class="anchor"></a>Executables and Libraries</h4><div class="odoc-spec"><div class="spec value" id="val-public_name" class="anchored"><a href="#val-public_name" class="anchor"></a><code><span><span class="keyword">val</span> public_name : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-name" class="anchored"><a href="#val-name" class="anchor"></a><code><span><span class="keyword">val</span> name : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-libraries" class="anchored"><a href="#val-libraries" class="anchor"></a><code><span><span class="keyword">val</span> libraries : 
  <span><span><span>[ <span>`L of string</span> <span><span>| `SplitL</span> of string</span> ]</span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>libraries</code> specifies the library’s dependencies.</p><ul><li><code>`L &quot;library&quot;</code> is an individual library.</li><li><code>`SplitL &quot;library1 library2 ...&quot;</code> is zero or more libraries split according to the <a href="https://github.com/janestreet/sexplib#lexical-conventions-of-s-expression">Lexical conventions of s-expression</a> for identifying atoms in a list.</li></ul><p>At least two other variants are reserved but have not been implemented:</p><ul><li><code>`Select ...</code></li><li><code>`Re_export ...</code></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-modules" class="anchored"><a href="#val-modules" class="anchor"></a><code><span><span class="keyword">val</span> modules : <span><span><span>[ `OrderedSet ]</span> <a href="#type-repr">repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>modules ordered_set</code> specifies what modules are part of the library.</p><p>By default, Dune will use all the .ml/.re files in the same directory as the dune file. This includes ones present in the file system as well as ones generated by user rules. You can restrict this list by using a <code>modules ordered_set</code> field. <code>modules</code> uses the <code>section-Ordered-Sets</code> Language, where elements are module names and don’t need to start with an uppercase letter. For instance, to exclude module <code>Foo</code>, use <code>modules (difference (standard) (set_of [&quot;foo&quot;]))</code>; in a real Dune file you would write that same expression as <code>&quot;(modules (:standard \ foo))&quot;</code></p><p>See <code>section-Ordered-Sets</code> for the operations you can perform.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-compilation_mode" class="anchored"><a href="#type-compilation_mode" class="anchor"></a><code><span><span class="keyword">type</span> compilation_mode</span><span> = </span></code><table><tr id="type-compilation_mode.Byte" class="anchored"><td class="def variant constructor"><a href="#type-compilation_mode.Byte" class="anchor"></a><code><span>| </span><span><span class="constructor">Byte</span></span></code></td></tr><tr id="type-compilation_mode.Native" class="anchored"><td class="def variant constructor"><a href="#type-compilation_mode.Native" class="anchor"></a><code><span>| </span><span><span class="constructor">Native</span></span></code></td></tr><tr id="type-compilation_mode.Best" class="anchored"><td class="def variant constructor"><a href="#type-compilation_mode.Best" class="anchor"></a><code><span>| </span><span><span class="constructor">Best</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>compilation_mode</code> must be byte, native, or best, where best is native with a fallback to bytecode when native compilation isn’t available.</p><span class="comment-delim">*)</span></td></tr></table></div></div><div class="odoc-spec"><div class="spec type" id="type-binary_kind" class="anchored"><a href="#type-binary_kind" class="anchor"></a><code><span><span class="keyword">type</span> binary_kind</span><span> = </span></code><table><tr id="type-binary_kind.C" class="anchored"><td class="def variant constructor"><a href="#type-binary_kind.C" class="anchor"></a><code><span>| </span><span><span class="constructor">C</span></span></code></td></tr><tr id="type-binary_kind.Exe" class="anchored"><td class="def variant constructor"><a href="#type-binary_kind.Exe" class="anchor"></a><code><span>| </span><span><span class="constructor">Exe</span></span></code></td></tr><tr id="type-binary_kind.Object" class="anchored"><td class="def variant constructor"><a href="#type-binary_kind.Object" class="anchor"></a><code><span>| </span><span><span class="constructor">Object</span></span></code></td></tr><tr id="type-binary_kind.Shared_object" class="anchored"><td class="def variant constructor"><a href="#type-binary_kind.Shared_object" class="anchor"></a><code><span>| </span><span><span class="constructor">Shared_object</span></span></code></td></tr><tr id="type-binary_kind.Js" class="anchored"><td class="def variant constructor"><a href="#type-binary_kind.Js" class="anchor"></a><code><span>| </span><span><span class="constructor">Js</span></span></code></td></tr><tr id="type-binary_kind.Plugin" class="anchored"><td class="def variant constructor"><a href="#type-binary_kind.Plugin" class="anchor"></a><code><span>| </span><span><span class="constructor">Plugin</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p><code>binary_kind</code> is one of:</p><ul><li><code>C</code> for producing OCaml bytecode embedded in a C file</li><li><code>Exe</code> for normal executables</li><li><code>Object</code> for producing static object files that can be manually linked into C applications</li><li><code>Shared_object</code> for producing object files that can be dynamically loaded into an application. This mode can be used to write a plugin in OCaml for a non-OCaml application.</li><li><code>Js</code> for producing JavaScript from bytecode executables, see explicit_js_mode.</li><li><code>Plugin</code> for producing a plugin (.cmxs if native or .cma if bytecode).</li></ul><span class="comment-delim">*)</span></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-modes" class="anchored"><a href="#val-modes" class="anchor"></a><code><span><span class="keyword">val</span> modes : 
  <span><span><span>[&lt; `C
  <span>| `Exe</span>
  <span>| `Object</span>
  <span>| `Shared_object</span>
  <span>| `Byte</span>
  <span>| `Native</span>
  <span>| `Js</span>
  <span>| `Plugin</span>
  <span>| `Byte_complete</span>
  <span><span>| `Mode</span> of <a href="#type-compilation_mode">compilation_mode</a> * <a href="#type-binary_kind">binary_kind</a></span> ]</span>
    list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p>The <code>modes</code> field allows selecting which linking modes will be used to link executables. Each mode is a pair (&lt;compilation-mode&gt; &lt;binary-kind&gt;), where &lt;compilation-mode&gt; describes whether the bytecode or native code backend of the OCaml compiler should be used and &lt;binary-kind&gt; describes what kind of file should be produced.</p><p>Refer to <a href="#type-compilation_mode"><code>compilation_mode</code></a> and <a href="#type-binary_kind"><code>binary_kind</code></a> for precise semantics.</p><p>For instance the following executables stanza will produce bytecode executables and native shared objects:</p><pre>      (executable
        (name &quot;a&quot;)
        (modes [`Mode (Byte, Exe); `Mode (Native; Shared_object)]))</pre><p>Additionally, you can use the following shorthands:</p><ul><li>`C for (byte c)</li><li>`Exe for (best exe)</li><li>`Object for (best object)</li><li>`Shared_object for (best shared_object)</li><li>`Byte for (byte exe)</li><li>`Native for (native exe)</li><li>`Js for (byte js)</li><li>`Plugin for (best plugin)</li></ul><p>Lastly, use the special mode <code>`Byte_complete</code> for building a bytecode executable as a native self-contained executable, i.e., an executable that doesn’t require the ocamlrun program to run and doesn’t require the C stubs to be installed as shared object files.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ocamlopt_flags" class="anchored"><a href="#val-ocamlopt_flags" class="anchor"></a><code><span><span class="keyword">val</span> ocamlopt_flags : 
  <span><span><span><span>[ `OCamlOptFlag ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-preprocess" class="anchored"><a href="#val-preprocess" class="anchor"></a><code><span><span class="keyword">val</span> preprocess : <span><span><span>[ `PreprocessSpec ]</span> <a href="#type-repr">repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `CommonExecutableLibrary ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>preprocess spec</code> specifies how to preprocess files when needed. The default is <a href="#val-no_preprocessing"><code>no_preprocessing</code></a>.</p><p>The full list of specifications is in <code>Preprocessing</code>.</p></div></div><h5 id="preprocessing"><a href="#preprocessing" class="anchor"></a>Preprocessing</h5><div class="odoc-spec"><div class="spec value" id="val-no_preprocessing" class="anchored"><a href="#val-no_preprocessing" class="anchor"></a><code><span><span class="keyword">val</span> no_preprocessing : <span><span>[ `PreprocessSpec ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>no_preprocessing</code> tells Dune to give files as-is to the compiler</p></div></div><div class="odoc-spec"><div class="spec value" id="val-pps" class="anchored"><a href="#val-pps" class="anchor"></a><code><span><span class="keyword">val</span> pps : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `PreprocessSpec ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>pps [ppx1; ppx2; ...]</code> preprocesses files using the given list of PPX rewriters</p></div></div><div class="odoc-spec"><div class="spec value" id="val-staged_pps" class="anchored"><a href="#val-staged_pps" class="anchor"></a><code><span><span class="keyword">val</span> staged_pps : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `PreprocessSpec ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>staged_pps [ppx1; ppx2; ...]</code> preprocesses files using the given list of PPX rewriters <b>after</b> dependency analysis.</p><p>It is slower than <a href="#val-pps"><code>pps</code></a>, but you must use <code>staged_pps</code> instead of <code>pps</code> in order to force Dune to use the following pipeline:</p><ol><li>first stage of code generation</li><li>dependency analysis</li><li>second step of code generation in parallel with compilation</li></ol></div></div><div class="odoc-spec"><div class="spec value" id="val-future_syntax" class="anchored"><a href="#val-future_syntax" class="anchor"></a><code><span><span class="keyword">val</span> future_syntax : <span><span>[ `PreprocessSpec ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>future_syntax</code> is equivalent to <a href="#val-no_preprocessing"><code>no_preprocessing</code></a> when using one of the most recent versions of the compiler. When using an older one, it is a shim preprocessor that backports some of the newer syntax elements. This allows you to use some of the new OCaml features while keeping compatibility with older compilers.</p></div></div><h5 id="ordered-sets"><a href="#ordered-sets" class="anchor"></a>Ordered Sets</h5><p>For fields that can take multiple arguments, an <code>[`OrderedSet] repr</code> lets you specify your arguments using set operations. You can:</p><ul><li>list each argument out individually with <a href="#val-set_of"><code>set_of</code></a></li><li><a href="#val-split"><code>split</code></a> a string into separate arguments</li><li>use the <a href="#val-standard"><code>standard</code></a> arguments</li><li>take the <a href="#val-union"><code>union</code></a> (also known as concatenation) of any other set</li><li>take the <a href="#val-difference"><code>difference</code></a> between two sets</li></ul><p>The authorative reference is <a href="https://dune.readthedocs.io/en/stable/concepts.html#ordered-set-language-1">Ordered Set Language</a>.</p><p>Here are some common sets to get your started:</p><ul><li><code>set_of [&quot;a&quot;; &quot;b&quot;; &quot;c&quot;]</code> are the set of arguments <code>&quot;a&quot;</code>, <code>&quot;b&quot;</code> and <code>&quot;c&quot;</code></li><li><code>split &quot;a b c&quot;</code> are the set of arguments <code>&quot;a&quot;</code>, <code>&quot;b&quot;</code> and <code>&quot;c&quot;</code></li><li><code>split &quot;{{#param-sets}} {{{ module }}} {{/param-sets}}&quot;</code> are the set of arguments after calculating the Mustache expression. The <code>&quot;param-sets&quot;</code> field of your parameter file will be available if you use the <code>pragma &quot;once&quot; ...</code>; see <a href="#val-pragma"><code>pragma</code></a>. With the example Mustache expression, Mustache will collect all of the <code>module</code> fields of your parameter file into a single string, and then <code>split</code> will split those modules by atoms.</li><li><code>(difference (standard) (set_of [&quot;foo&quot;]))</code> which is all the standard arguments (ex. standard modules) except for <code>&quot;foo&quot;</code>. In a real Dune file would be written as <code>&quot;(:standard \ foo)&quot;</code></li></ul><p>It is allowed grammatically but is highly discouraged to use <code>split &quot;:standard \ compat&quot;</code>. Instead use <code>difference (standard) (each [&quot;compat&quot;])</code> so the meaning is clear and so that DSL interpreters are exposed to what you actually meant to happen.</p><div class="odoc-spec"><div class="spec value" id="val-set_of" class="anchored"><a href="#val-set_of" class="anchor"></a><code><span><span class="keyword">val</span> set_of : <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `OrderedSet ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>set_of [arg1; arg2; ...]</code> are zero or more arguments <code>arg1</code>, <code>arg2</code> and so on.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-standard" class="anchored"><a href="#val-standard" class="anchor"></a><code><span><span class="keyword">val</span> standard : <span><span>[ `OrderedSet ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>standard</code> are the standard arguments.</p><p>The standard depends on the context in which the arguments are applied. See the relevant documentation for the definition of <code>standard</code>:</p><ul><li><a href="#val-modules"><code>modules</code></a></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-split" class="anchored"><a href="#val-split" class="anchor"></a><code><span><span class="keyword">val</span> split : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `OrderedSet ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>split &quot;arg1 arg2 ...&quot;</code> are zero or more arguments <code>arg1</code>, <code>arg2</code> and so on after splitting the given string <code>&quot;arg1 arg2 ...&quot;</code> according to the <a href="https://github.com/janestreet/sexplib#lexical-conventions-of-s-expression">Lexical conventions of s-expression</a> for identifying atoms in a list.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-union" class="anchored"><a href="#val-union" class="anchor"></a><code><span><span class="keyword">val</span> union : <span><span><span><span>[ `OrderedSet ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `OrderedSet ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>union [set1; set2; ...]</code> is all the arguments from <code>set1</code> and also <code>set2</code> and so on.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-difference" class="anchored"><a href="#val-difference" class="anchor"></a><code><span><span class="keyword">val</span> difference : 
  <span><span><span>[ `OrderedSet ]</span> <a href="#type-repr">repr</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span><span>[ `OrderedSet ]</span> <a href="#type-repr">repr</a></span> <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `OrderedSet ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><code>difference a_set b_set</code> is all the arguments from <code>a_set</code> that are not in <code>b_set</code></p></div></div><h4 id="install"><a href="#install" class="anchor"></a>Install</h4><div class="odoc-spec"><div class="spec value" id="val-section" class="anchored"><a href="#val-section" class="anchor"></a><code><span><span class="keyword">val</span> section : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Install ]</span> <a href="#type-repr">repr</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-install_files" class="anchored"><a href="#val-install_files" class="anchor"></a><code><span><span class="keyword">val</span> install_files : <span><span><span><span>[ `InstallDestination ]</span> <a href="#type-repr">repr</a></span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Install ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><a href="https://dune.readthedocs.io/en/stable/dune-files.html#install-1">https://dune.readthedocs.io/en/stable/dune-files.html#install-1</a>.</p><p>Can either be:</p><pre>      (files   (mylib.el as emacs/site-lisp/mylib.el))</pre><p>or</p><pre>      (files hello.txt)</pre></div></div><h5 id="install-destination"><a href="#install-destination" class="anchor"></a>Install Destination</h5><div class="odoc-spec"><div class="spec value" id="val-destination_file" class="anchored"><a href="#val-destination_file" class="anchor"></a><code><span><span class="keyword">val</span> destination_file : 
  <span>filename:string <span class="arrow">&#45;&gt;</span></span>
  <span>destination:string <span class="arrow">&#45;&gt;</span></span>
  <span><span>[ `InstallDestination ]</span> <a href="#type-repr">repr</a></span></span></code></div><div class="spec-doc"><p><a href="https://dune.readthedocs.io/en/stable/dune-files.html#install-1">https://dune.readthedocs.io/en/stable/dune-files.html#install-1</a>.</p><p>Represents:</p><pre>      (mylib.el as emacs/site-lisp/mylib.el)</pre><p>in</p><pre>        (files   (mylib.el as emacs/site-lisp/mylib.el))</pre></div></div></div></body></html>